
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 u_vel (InputLayer)             [(None, 256, 256)]   0           []
 v_vel (InputLayer)             [(None, 256, 256)]   0           []
 w_vel (InputLayer)             [(None, 256, 256)]   0           []
 pr0.2 (InputLayer)             [(None, 256, 256)]   0           []
 periodic_padding2d (PeriodicPa  (None, 272, 272)    0           ['u_vel[0][0]']
 dding2D)
 periodic_padding2d_1 (Periodic  (None, 272, 272)    0           ['v_vel[0][0]']
 Padding2D)
 periodic_padding2d_2 (Periodic  (None, 272, 272)    0           ['w_vel[0][0]']
 Padding2D)
 periodic_padding2d_3 (Periodic  (None, 272, 272)    0           ['pr0.2[0][0]']
 Padding2D)
 reshape (Reshape)              (None, 272, 272, 1)  0           ['periodic_padding2d[0][0]']
 reshape_1 (Reshape)            (None, 272, 272, 1)  0           ['periodic_padding2d_1[0][0]']
 reshape_2 (Reshape)            (None, 272, 272, 1)  0           ['periodic_padding2d_2[0][0]']
 reshape_3 (Reshape)            (None, 272, 272, 1)  0           ['periodic_padding2d_3[0][0]']
 concatenate (Concatenate)      (None, 272, 272, 4)  0           ['reshape[0][0]',
                                                                  'reshape_1[0][0]',
                                                                  'reshape_2[0][0]',
                                                                  'reshape_3[0][0]']
 batch_normalization (BatchNorm  (None, 272, 272, 4)  16         ['concatenate[0][0]']
 alization)
 conv2d (Conv2D)                (None, 268, 268, 64  6464        ['batch_normalization[0][0]']
                                )
 batch_normalization_1 (BatchNo  (None, 268, 268, 64  256        ['conv2d[0][0]']
 rmalization)                   )
 conv2d_1 (Conv2D)              (None, 266, 266, 12  73856       ['batch_normalization_1[0][0]']
                                8)
 batch_normalization_2 (BatchNo  (None, 266, 266, 12  512        ['conv2d_1[0][0]']
 rmalization)                   8)
 conv2d_2 (Conv2D)              (None, 264, 264, 25  295168      ['batch_normalization_2[0][0]']
                                6)
 batch_normalization_3 (BatchNo  (None, 264, 264, 25  1024       ['conv2d_2[0][0]']
 rmalization)                   6)
 conv2d_3 (Conv2D)              (None, 262, 262, 25  590080      ['batch_normalization_3[0][0]']
                                6)
 batch_normalization_4 (BatchNo  (None, 262, 262, 25  1024       ['conv2d_3[0][0]']
 rmalization)                   6)
 concatenate_1 (Concatenate)    (None, 262, 262, 51  0           ['conv2d_3[0][0]',
                                2)                                'batch_normalization_4[0][0]']
 conv2d_transpose (Conv2DTransp  (None, 264, 264, 12  589952     ['concatenate_1[0][0]']
 ose)                           8)
 batch_normalization_5 (BatchNo  (None, 264, 264, 12  512        ['conv2d_transpose[0][0]']
 rmalization)                   8)
 concatenate_2 (Concatenate)    (None, 264, 264, 38  0           ['conv2d_2[0][0]',
                                4)                                'batch_normalization_5[0][0]']
 conv2d_transpose_1 (Conv2DTran  (None, 266, 266, 25  884992     ['concatenate_2[0][0]']
 spose)                         6)
 batch_normalization_6 (BatchNo  (None, 266, 266, 25  1024       ['conv2d_transpose_1[0][0]']
 rmalization)                   6)
 concatenate_3 (Concatenate)    (None, 266, 266, 38  0           ['conv2d_1[0][0]',
                                4)                                'batch_normalization_6[0][0]']
 conv2d_transpose_2 (Conv2DTran  (None, 268, 268, 25  884992     ['concatenate_3[0][0]']
 spose)                         6)
 batch_normalization_7 (BatchNo  (None, 268, 268, 25  1024       ['conv2d_transpose_2[0][0]']
 rmalization)                   6)
 concatenate_4 (Concatenate)    (None, 268, 268, 32  0           ['conv2d[0][0]',
                                0)                                'batch_normalization_7[0][0]']
 conv2d_transpose_3 (Conv2DTran  (None, 272, 272, 64  512064     ['concatenate_4[0][0]']
 spose)                         )
 batch_normalization_8 (BatchNo  (None, 272, 272, 64  256        ['conv2d_transpose_3[0][0]']
 rmalization)                   )
 concatenate_5 (Concatenate)    (None, 272, 272, 68  0           ['concatenate[0][0]',
                                )                                 'batch_normalization_8[0][0]']
 conv2d_transpose_4 (Conv2DTran  (None, 272, 272, 1)  69         ['concatenate_5[0][0]']
 spose)
 cropping2d (Cropping2D)        (None, 256, 256, 1)  0           ['conv2d_transpose_4[0][0]']
==================================================================================================
Total params: 3,843,285
Trainable params: 3,840,461
Non-trainable params: 2,824
__________________________________________________________________________________________________

      5/Unknown - 19s 663ms/step - loss: 760.1766













































    146/Unknown - 109s 641ms/step - loss: 310.7181
Traceback (most recent call last):
  File "23-1-6_newcase.py", line 42, in <module>
    hist = model.fit(train_dl,validation_data=val_dl,
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/wandb/integration/keras/keras.py", line 174, in new_v2
    return old_v2(*args, **kwargs)
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/wandb/integration/keras/keras.py", line 174, in new_v2
    return old_v2(*args, **kwargs)
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/wandb/integration/keras/keras.py", line 174, in new_v2
    return old_v2(*args, **kwargs)
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/keras/utils/traceback_utils.py", line 65, in error_handler
    return fn(*args, **kwargs)
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/keras/engine/training.py", line 1570, in fit
    callbacks.on_train_batch_end(end_step, logs)
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/keras/callbacks.py", line 470, in on_train_batch_end
    self._call_batch_hook(ModeKeys.TRAIN, "end", batch, logs=logs)
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/keras/callbacks.py", line 317, in _call_batch_hook
    self._call_batch_end_hook(mode, batch, logs)
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/keras/callbacks.py", line 340, in _call_batch_end_hook
    self._call_batch_hook_helper(hook_name, batch, logs)
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/keras/callbacks.py", line 385, in _call_batch_hook_helper
    logs = self._process_logs(logs, is_batch_hook=True)
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/keras/callbacks.py", line 292, in _process_logs
    return tf_utils.sync_to_numpy_or_python_type(logs)
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/keras/utils/tf_utils.py", line 635, in sync_to_numpy_or_python_type
    return tf.nest.map_structure(_to_single_numpy_or_python_type, tensors)
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/tensorflow/python/util/nest.py", line 917, in map_structure
    structure[0], [func(*x) for x in entries],
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/tensorflow/python/util/nest.py", line 917, in <listcomp>
    structure[0], [func(*x) for x in entries],
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/keras/utils/tf_utils.py", line 628, in _to_single_numpy_or_python_type
    t = t.numpy()
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/tensorflow/python/framework/ops.py", line 1157, in numpy
    maybe_arr = self._numpy()  # pylint: disable=protected-access
  File "/home/yuning/anaconda3/envs/tensor2/lib/python3.8/site-packages/tensorflow/python/framework/ops.py", line 1123, in _numpy
    return self._numpy_internal()

    148/Unknown - 111s 642ms/step - loss: 307.1888